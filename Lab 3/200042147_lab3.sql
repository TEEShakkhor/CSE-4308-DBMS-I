CREATE TABLE ACCOUNT( 
	ACCOUNT_NO CHAR(5), 
	BALANCE NUMBER NOT NULL, 
	CONSTRAINT PK_ACCOUNT PRIMARY KEY(ACCOUNT_NO) 
);

CREATE TABLE CUSTOMER(
    CUSTOMER_NO CHAR(5),
    CUSTOMER_NAME VARCHAR2(20) NOT NULL,
    CUSTOMER_CITY VARCHAR2(10),
    CONSTRAINT PK_CUSTOMER PRIMARY KEY(CUSTOMER_NO)
);

CREATE TABLE DEPOSITOR(
      ACCOUNT_NO CHAR(5),
      CUSTOMER_NO CHAR(5),
      CONSTRAINT PK_DEPOSITOR PRIMARY KEY(ACCOUNT_NO,CUSTOMER_NO)
);

ALTER TABLE CUSTOMER ADD DATE_OF_BIRTH DATE;

ALTER TABLE ACCOUNT MODIFY BALANCE NUMBER(12, 2);

ALTER TABLE DEPOSITOR RENAME COLUMN ACCOUNT_NO TO A_NO;

ALTER TABLE DEPOSITOR RENAME COLUMN CUSTOMER_NO TO C_NO;

ALTER TABLE DEPOSITOR RENAME TO DEPOSITOR_INFO;

ALTER TABLE DEPOSITOR_INFO ADD CONSTRAINT FK_DEPOSITOR_ACCOUNT FOREIGN KEY(A_NO) REFERENCES ACCOUNT(ACCOUNT_NO);

ALTER TABLE DEPOSITOR_INFO ADD CONSTRAINT FK_DEPOSITOR_CUSTOMER FOREIGN KEY(C_NO) REFERENCES CUSTOMER(CUSTOMER_NO);


INSERT INTO ACCOUNT VALUES(10001, '20000');
INSERT INTO ACCOUNT VALUES(10002, '30000');
INSERT INTO ACCOUNT VALUES(10003, '4000');
INSERT INTO ACCOUNT VALUES(10004, '2000');
INSERT INTO ACCOUNT VALUES(10005, '2000000');

INSERT INTO CUSTOMER VALUES(20001, 'ANAN', 'JES', '1-JAN-2001');
INSERT INTO CUSTOMER VALUES(20002, 'SHAKKHOR', 'DNJ', '1-FEB-2001');
INSERT INTO CUSTOMER VALUES(20003, 'TAHLIL', 'KHL', '1-MARCH-2001');
INSERT INTO CUSTOMER VALUES(20004, 'AKASH', 'DHK', '1-APRIL-2001');
INSERT INTO CUSTOMER VALUES(20005, 'DAYAN', 'KHL', '1-MAY-2001');

INSERT INTO DEPOSITOR_INFO VALUES(10001, 20001);
INSERT INTO DEPOSITOR_INFO VALUES(10002, 20002);
INSERT INTO DEPOSITOR_INFO VALUES(10003, 20003);
INSERT INTO DEPOSITOR_INFO VALUES(10004, 20004);
INSERT INTO DEPOSITOR_INFO VALUES(10005, 20005);

SELECT ACCOUNT_NO FROM ACCOUNT WHERE BALANCE<100000;

SELECT CUSTOMER_NAME FROM CUSTOMER WHERE CUSTOMER_CITY = 'KHL';

SELECT CUSTOMER_NAME FROM CUSTOMER WHERE CUSTOMER_NAME LIKE '%A%';

SELECT DISTINCT A_NO FROM DEPOSITOR_INFO;

SELECT * FROM ACCOUNT, DEPOSITOR_INFO;

SELECT * FROM CUSTOMER NATURAL JOIN DEPOSITOR_INFO;

SELECT CUSTOMER_NAME,CUSTOMER_CITY
FROM CUSTOMER C,DEPOSITOR_INFO D,ACCOUNT A
WHERE C.CUSTOMER_NO = D.C_NO AND D.A_NO = A.ACCOUNT_NO;

SELECT CUSTOMER_NO,CUSTOMER_NAME,CUSTOMER_CITY
FROM CUSTOMER C,DEPOSITOR_INFO D,ACCOUNT A
WHERE C.CUSTOMER_NO = D.C_NO AND D.A_NO = A.ACCOUNT_NO AND A.BALANCE>1000;

SELECT ACCOUNT_NO,BALANCE
FROM ACCOUNT A,DEPOSITOR_INFO D,CUSTOMER C
WHERE D.A_NO = A.ACCOUNT_NO AND C.CUSTOMER_NO = D.C_NO
AND ((A.BALANCE>=5000 AND A.BALANCE<=10000) OR C.CUSTOMER_CITY='DHK');



